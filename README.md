# Start the environment

docker-compose up -d

# User

Create a test user.

# Clients

Each microservices will be registered as a client.

# Microservice authentication

## Service to Service authentication using Client Credentials Flow

1. Create a new Realm in KeyCloak named `routific`.
1. Check how to configure a client application [here](https://www.youtube.com/watch?v=hGatG58RrOo). Configure a KeyCloak client.
1. Update the planning-service app client secret
1. Do an API request to planning-service in the endpoint `/`.


### How does it work?

1. Planning-Service does an API request to Keycloak
   1. It provides its application secret and application client
2. It retrieves a token
3. The token is propagated to the notification server
4. The notification server confirms that the token was generated by keycloak
   1. Additional validation can be performed such as audience and other things we can think about later
5. Notification server accepts the token if it was generated by keycloak. 

This flow may be useful for customer API authentication as well, we could generate a new application for each customer api token, and they could retrieve tokens for their API calls.